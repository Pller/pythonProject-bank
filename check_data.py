"""–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö."""
import pandas as pd
import sys

sys.path.append('src')

from utils import read_excel_file


def main():
    print("üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö...")

    df = read_excel_file('data/operations.xlsx')

    if df.empty:
        print("‚ùå –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –ø—É—Å—Ç–æ–π")
        print("üìù –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥–æ–π: python create_sample_data.py")
        return

    print(f"‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ")
    print(f"üìä –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: {len(df)} —Å—Ç—Ä–æ–∫, {len(df.columns)} –∫–æ–ª–æ–Ω–æ–∫")
    print(f"üìÖ –ü–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö: {df['–î–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏'].min()} - {df['–î–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏'].max()}")

    print("\nüìã –ö–æ–ª–æ–Ω–∫–∏:")
    for i, col in enumerate(df.columns, 1):
        print(f"  {i:2d}. {col}")

    print(f"\nüí∞ –î–∏–∞–ø–∞–∑–æ–Ω —Å—É–º–º: {df['–°—É–º–º–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏'].min():.2f} - {df['–°—É–º–º–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏'].max():.2f}")

    if '–ö–∞—Ç–µ–≥–æ—Ä–∏—è' in df.columns:
        print(f"\nüè∑Ô∏è  –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ ({df['–ö–∞—Ç–µ–≥–æ—Ä–∏—è'].nunique()} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö):")
        for category, count in df['–ö–∞—Ç–µ–≥–æ—Ä–∏—è'].value_counts().head(10).items():
            print(f"  - {category}: {count} —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π")

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π
    test_cases = [
        ('–ü–µ—Ä–µ–≤–æ–¥—ã', '–ü–æ–∏—Å–∫ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Ñ–∏–∑–ª–∏—Ü–∞–º'),
        ('–¢–µ–ª–µ—Ñ–æ–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞', '–ü–æ–∏—Å–∫ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–º –Ω–æ–º–µ—Ä–∞–º')
    ]

    print(f"\nüîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π:")
    for test_name, function_name in test_cases:
        if test_name == '–ü–µ—Ä–µ–≤–æ–¥—ã' and '–ö–∞—Ç–µ–≥–æ—Ä–∏—è' in df.columns:
            transfers = df[df['–ö–∞—Ç–µ–≥–æ—Ä–∏—è'] == '–ü–µ—Ä–µ–≤–æ–¥—ã']
            print(f"  - {function_name}: {len(transfers)} —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π")

        if test_name == '–¢–µ–ª–µ—Ñ–æ–Ω–Ω—ã–µ –Ω–æ–º–µ—Ä–∞' and '–û–ø–∏—Å–∞–Ω–∏–µ' in df.columns:
            phones = df[df['–û–ø–∏—Å–∞–Ω–∏–µ'].str.contains(r'\+\d', na=False)]
            print(f"  - {function_name}: {len(phones)} —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π")


if __name__ == "__main__":
    main()
